# 도메인 모델 (Domain Model)

> 작성일: 2025-12-13

## 개요

보험 온톨로지 시스템의 비즈니스 도메인을 설명합니다. 이 시스템은 **손해보험 건강보험 상품**의 약관, 담보, 급부 정보를 구조화하여 관리합니다.

---

## 1. 도메인 구성

```
┌─────────────────────────────────────────────────────────────────┐
│                      보험 온톨로지 시스템                          │
├─────────────────┬─────────────────┬─────────────────┬───────────┤
│   보험 도메인     │    문서 도메인     │   코드 도메인    │  검색 도메인 │
├─────────────────┼─────────────────┼─────────────────┼───────────┤
│ • 보험사         │ • 약관 문서       │ • 질병코드집합   │ • 벡터임베딩 │
│ • 상품           │ • 문서 조항       │ • KCD/ICD 코드  │ • 조항-담보  │
│ • 상품변형       │ • 구조화 데이터   │                 │   매핑      │
│ • 담보카테고리   │                  │                 │            │
│ • 담보군         │                  │                 │            │
│ • 담보           │                  │                 │            │
│ • 급부/조건/제외 │                  │                 │            │
└─────────────────┴─────────────────┴─────────────────┴───────────┘
```

---

## 2. 보험 도메인

### 2.1 Company (보험사)

**정의**: 보험 상품을 판매하는 금융회사

| 속성 | 설명 | 예시 |
|------|------|------|
| company_code | 회사 식별 코드 | samsung, db, lotte, kb |
| company_name | 회사명 | 삼성, DB, 롯데, KB |
| business_type | 사업 유형 | 손해보험, 생명보험 |

**현재 데이터**: 8개 손해보험사
- 삼성, DB, 롯데, KB, 현대, 한화, 흥국, 메리츠

### 2.2 Product (보험 상품)

**정의**: 보험사가 판매하는 보험 상품 단위

| 속성 | 설명 | 예시 |
|------|------|------|
| product_code | 상품 코드 | myhealthpartner, newmagicplus |
| product_name | 상품명 | (무)마이헬스파트너건강보험 |
| version | 상품 버전 | 2024.09 |
| effective_date | 적용 시작일 | 2024-09-01 |

**비즈니스 규칙**:
- 한 보험사는 여러 상품을 보유
- 상품은 버전 관리됨 (약관 개정 시 새 버전)

### 2.3 Product Variant (상품 변형)

**정의**: 동일 상품 내 가입조건에 따른 변형

| 변형 유형 | 설명 | 예시 |
|-----------|------|------|
| 성별 분리 | 남/여 별도 상품 | 롯데 NEW매직플러스 남성용/여성용 |
| 연령 분리 | 연령대별 상품 | DB 40세 이하/41세 이상 |
| 종류 분리 | 보장 범위 차이 | 1종/3종/4종 |
| 형태 분리 | 납입/환급 방식 | 순수보장형/환급형 |

### 2.4 Coverage Category (담보 카테고리)

**정의**: 담보를 보장 유형별로 분류하는 카테고리

| 카테고리 코드 | 한글명 | 설명 |
|---------------|--------|------|
| death_disability | 사망/장해/장애군 | 사망, 후유장해 보장 |
| dementia_long_term_care | 치매 및 장기요양군 | 치매, 장기요양 보장 |
| cancer_diagnosis | 암진단군 | 암 진단금 |
| major_disease_diagnosis | 2대질병진단군 | 뇌/심장 질환 |
| specific_disease_diagnosis | 특정질병진단군 | 기타 특정 질병 |
| hospitalization | 입원군 | 입원비 보장 |
| surgery | 수술군 | 수술비 보장 |
| outpatient | 통원군 | 통원비 보장 |
| other_benefits | 기타보장군 | 기타 |

### 2.5 Coverage Group (특별약관군)

**정의**: 약관 문서에서 함께 묶이는 담보 그룹

| 속성 | 설명 | 예시 |
|------|------|------|
| group_code | 그룹 코드 | cancer_diagnosis_group |
| group_name_kr | 그룹명 | 무배당암 진단 보장 특별약관군 |
| is_renewable | 갱신형 여부 | true/false |
| group_number | 약관 목차 번호 | 4, 5, 6... |

### 2.6 Coverage (담보)

**정의**: 보험 상품의 개별 보장 항목 (특별약관 단위)

| 속성 | 설명 | 예시 |
|------|------|------|
| coverage_code | 담보 코드 | cancer_diag_basic |
| coverage_name | 담보명 | 암진단금(기본형) |
| coverage_category | 담보 카테고리 | 암진단 |
| renewal_type | 갱신 유형 | 갱신형, 비갱신형 |
| is_basic | 기본형 여부 | true (기본형), false (고급형 등) |

**계층 구조**:
```
암진단금(I형) [부모]
├── 일반암진단금 [자식]
├── 고액암진단금 [자식]
├── 소액암진단금 [자식]
└── 유사암진단금 [자식]
```

### 2.7 Benefit (급부)

**정의**: 담보에서 지급하는 보험금 항목

| 속성 | 설명 | 예시 |
|------|------|------|
| benefit_name | 급부명 | 암진단금 |
| benefit_type | 급부 유형 | 진단금, 수술비, 입원일당 |
| benefit_amount | 지급 금액 | 3000000 (3백만원) |
| payment_frequency | 지급 빈도 | 1회, 연 1회, 진단시 1회 |

### 2.8 Condition (보장 조건)

**정의**: 담보의 보장 적용 조건

| 조건 유형 | 설명 | 예시 |
|-----------|------|------|
| diagnosis | 진단 조건 | C코드 확정진단 |
| age | 연령 조건 | 15세~80세 |
| waiting_period | 면책/감액 기간 | 90일 면책, 1년 50% 감액 |

### 2.9 Exclusion (보장 제외)

**정의**: 담보에서 보장하지 않는 사항

| 제외 유형 | 설명 | 예시 |
|-----------|------|------|
| disease | 질병 제외 | 기타피부암, 갑상선암 제외 |
| cause | 원인 제외 | 고의 사고, 음주운전 |
| situation | 상황 제외 | 전쟁, 천재지변 |

---

## 3. 문서 도메인

### 3.1 Document (문서)

**정의**: 보험 관련 공식 문서

| 문서 유형 (doc_type) | 설명 |
|---------------------|------|
| terms | 보험약관 |
| business_spec | 사업방법서 |
| product_summary | 상품요약서 |
| proposal | 가입설계서 |
| easy_summary | 알기쉬운 상품설명서 |

### 3.2 Document Clause (문서 조항)

**정의**: 문서 내 개별 조항 또는 청크

| 조항 유형 (clause_type) | 설명 |
|------------------------|------|
| article | 조문 (제1조, 제2조...) |
| table_row | 표의 행 |
| text_block | 텍스트 블록 |
| list_item | 목록 항목 |
| heading | 제목/헤딩 |

| 섹션 유형 (section_type) | 설명 |
|-------------------------|------|
| 보통약관 | 공통 적용 조항 |
| 특별약관 | 담보별 약관 |
| 별표 | 질병분류표, 수술분류표 등 |

---

## 4. 코드 도메인

### 4.1 Disease Code Set (질병코드 집합)

**정의**: 보험사에서 사용하는 질병코드 분류 집합

| 집합명 | 설명 |
|--------|------|
| 악성신생물 | 암(C코드) 분류 |
| 제자리신생물 | D00-D09 |
| 기타피부암 | C44 (보통 제외 대상) |
| 갑상선암 | C73 (보통 소액암) |
| 뇌출혈 | 뇌내출혈, 거미막하출혈 |
| 뇌경색 | I63 |
| 뇌졸중 | 뇌혈관질환 전체 |
| 급성심근경색 | I21 |
| 허혈성심장질환 | I20-I25 |

### 4.2 Disease Code (질병 코드)

**정의**: KCD/ICD 표준 질병 코드

| 코드 체계 | 설명 |
|-----------|------|
| KCD | 한국표준질병사인분류 (현재 KCD-8) |
| ICD | 국제질병분류 |

---

## 5. 검색 도메인

### 5.1 Clause Embedding (조항 임베딩)

**정의**: 문서 조항의 벡터 표현

| 속성 | 설명 |
|------|------|
| embedding | 1536차원 벡터 (text-embedding-3-small) |
| model_name | 임베딩 모델명 |
| metadata | 검색 필터용 메타데이터 (coverage_ids, clause_type 등) |

### 5.2 Clause Coverage (조항-담보 매핑)

**정의**: 문서 조항과 담보 간의 관계 매핑

| 속성 | 설명 |
|------|------|
| relevance_score | 관련도 점수 (0.0~1.0) |
| extraction_method | 추출 방법 (exact_match, fuzzy_match, llm) |

**용도**: 벡터 검색 시 특정 담보 관련 조항만 필터링

---

## 6. 핵심 비즈니스 흐름

### 6.1 상품 구조 조회

```
보험사 → 상품 → 담보군 → 담보 → 급부/조건/제외
                    ↓
              담보카테고리
```

### 6.2 약관 검색 흐름

```
사용자 질문
    ↓
벡터 임베딩 생성
    ↓
clause_embedding에서 유사도 검색
    ↓
clause_coverage로 담보 필터링 (선택)
    ↓
관련 조항 반환
```

### 6.3 담보 비교 흐름

```
상품 A 담보 목록 ←→ 상품 B 담보 목록
        ↓
    담보명/조건/급부 비교
        ↓
    차이점 분석
```

---

## 7. 확장 계획

### 7.1 미구현 엔티티

| 엔티티 | 설명 | 우선순위 |
|--------|------|----------|
| RiskEvent | 보험사고 (진단, 사망, 입원 등) | 높음 |
| Plan | 가입설계서 (고객별 설계) | 중간 |
| Rider | 특약 (기본상품에 추가) | 낮음 |

### 7.2 미구현 관계

| 관계 | 설명 |
|------|------|
| Coverage → RiskEvent | 담보가 보장하는 보험사고 |
| Plan → Coverage | 설계서에 포함된 담보 |
| Benefit → Condition | 급부 지급 조건 |

---

## 참고 문서

- [ER_DIAGRAM.md](./ER_DIAGRAM.md) - E-R 다이어그램
- [DATA_DICTIONARY.md](./DATA_DICTIONARY.md) - 데이터 사전
- [ONTOLOGY_GAP_ANALYSIS.md](./ONTOLOGY_GAP_ANALYSIS.md) - 온톨로지 갭 분석
