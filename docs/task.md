# Database Refactoring Tasks

**ì‹œì‘ì¼**: 2025-12-13
**ëª©í‘œ ì™„ë£Œì¼**: 2025-12-27
**í˜„ì¬ ìƒíƒœ**: ì§„í–‰ ì¤‘

---

## ìƒíƒœ ë²”ë¡€

| ìƒíƒœ | ì„¤ëª… |
|------|------|
| â¬œ PENDING | ì•„ì§ ì‹œì‘í•˜ì§€ ì•ŠìŒ |
| ğŸ”„ IN_PROGRESS | ì§„í–‰ ì¤‘ |
| âœ… COMPLETED | ì™„ë£Œë¨ |
| âŒ FAILED | ì‹¤íŒ¨ (ì›ì¸ ê¸°ë¡ í•„ìš”) |
| â¸ï¸ BLOCKED | ë‹¤ë¥¸ ì‘ì—…ì— ì˜í•´ ì°¨ë‹¨ë¨ |

---

## ì „ì²´ Task ì˜ì¡´ì„± ë‹¤ì´ì–´ê·¸ë¨

```
Phase 1 (ìŠ¤í‚¤ë§ˆ ì¶”ì¶œ) âœ…
    â”œâ”€â”€ Phase 1.5a (PostgreSQL ì„¤ê³„ ë¬¸ì„œ) âœ…
    â”‚       â””â”€â”€ Phase 3 (ìŠ¤í¬ë¦½íŠ¸/ê²€ì¦ ë„êµ¬)
    â”‚               â””â”€â”€ Phase 6 (CI/CD)
    â”œâ”€â”€ Phase 1.5b (Neo4j ì„¤ê³„ ë¬¸ì„œ) âœ…
    â”‚       â””â”€â”€ Phase 4 (Neo4j ìŠ¤í‚¤ë§ˆ)
    â”‚               â””â”€â”€ Phase 7 (ì˜¨í†¨ë¡œì§€ í™•ì¥)
    â”œâ”€â”€ Phase 2 (Alembic) âœ…
    â”‚       â””â”€â”€ Phase 2.5 (DB ì „í™˜) âœ…
    â”‚               â””â”€â”€ Phase 3 (ìŠ¤í¬ë¦½íŠ¸/ê²€ì¦ ë„êµ¬)
    â””â”€â”€ Phase 5 (pgvector) [ë…ë¦½]
```

---

## ì„¤ê³„ â†’ êµ¬í˜„ ì—°ê²° ê´€ê³„

ì„¤ê³„ ë¬¸ì„œì™€ êµ¬í˜„ íŒŒì¼ ê°„ì˜ ì—°ê²°ì„ ëª…í™•íˆ í•©ë‹ˆë‹¤.

### PostgreSQL

```
ì„¤ê³„ ë¬¸ì„œ                              êµ¬í˜„ íŒŒì¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
db_refactoring/docs/
â”œâ”€â”€ ER_DIAGRAM.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ postgres/001_initial_schema.sql âœ…
â”œâ”€â”€ DATA_DICTIONARY.md                postgres/002_seed_data.sql âœ…
â”œâ”€â”€ RELATIONSHIP_MAP.md
â””â”€â”€ DOMAIN_MODEL.md
```

### Neo4j

```
ì„¤ê³„ ë¬¸ì„œ                              êµ¬í˜„ íŒŒì¼
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
db_refactoring/docs/
â”œâ”€â”€ GRAPH_SCHEMA.md â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ neo4j/001_graph_schema.cypher â¬œ (Phase 4.1)
â”œâ”€â”€ NODE_DICTIONARY.md                ingestion/graph_loader.py âœ…
â”œâ”€â”€ RELATIONSHIP_DICTIONARY.md
â”œâ”€â”€ GRAPH_PATTERNS.md
â””â”€â”€ ONTOLOGY_GAP_ANALYSIS.md
```

### ë¬¸ì„œ ì¸ë±ìŠ¤

ì „ì²´ ë¬¸ì„œ êµ¬ì¡°ëŠ” [`db_refactoring/docs/README.md`](../db_refactoring/docs/README.md) ì°¸ì¡°

---

## Phase 1: ìŠ¤í‚¤ë§ˆ ì¶”ì¶œ (Day 1-2)

**ëª©í‘œ**: í˜„ì¬ PostgreSQL ìŠ¤í‚¤ë§ˆë¥¼ SQL íŒŒì¼ë¡œ ì¶”ì¶œ
**ì„ í–‰ ì¡°ê±´**: ì—†ìŒ (ì²« ë²ˆì§¸ ì‘ì—…)
**í›„í–‰ ì‘ì—…**: Phase 1.5, Phase 2, Phase 5

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 1.1 | ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„± | âœ… COMPLETED | - | 2025-12-13 | 2025-12-13 |
| 1.2 | í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë¤í”„ ì‹¤í–‰ | âœ… COMPLETED | 1.1 | 2025-12-13 | 2025-12-13 |
| 1.3 | `db_refactoring/postgres/001_initial_schema.sql` ì •ë¦¬ | âœ… COMPLETED | 1.2 | 2025-12-13 | 2025-12-13 |
| 1.4 | `db_refactoring/postgres/002_seed_data.sql` ìƒì„± | âœ… COMPLETED | 1.2 | 2025-12-13 | 2025-12-13 |
| 1.5 | ìŠ¤í‚¤ë§ˆ íŒŒì¼ ê²€ì¦ (ì¬ì ìš© í…ŒìŠ¤íŠ¸) | âœ… COMPLETED | 1.3, 1.4 | 2025-12-13 | 2025-12-13 |

### Task ìƒì„¸

#### 1.1 ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | `db_refactoring/postgres/`, `db_refactoring/neo4j/`, `db_refactoring/docs/`, `db_refactoring/scripts/`, `db_refactoring/migrations/` êµ¬ì¡° ìƒì„± |
| ëª…ë ¹ì–´ | `mkdir -p db/{postgres,neo4j,docs,scripts,migrations/versions}` |
| ì™„ë£Œ ê¸°ì¤€ | ëª¨ë“  ë””ë ‰í† ë¦¬ ì¡´ì¬ í™•ì¸ |

#### 1.2 í˜„ì¬ ìŠ¤í‚¤ë§ˆ ë¤í”„ ì‹¤í–‰

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | pg_dumpë¥¼ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ PostgreSQL ìŠ¤í‚¤ë§ˆ ì¶”ì¶œ |
| ëª…ë ¹ì–´ | `pg_dump "postgresql://postgres:postgres@127.0.0.1:5432/insurance_ontology" --schema-only --no-owner --no-privileges > db_refactoring/postgres/001_initial_schema.sql` |
| ì™„ë£Œ ê¸°ì¤€ | SQL íŒŒì¼ ìƒì„±, ë¬¸ë²• ì˜¤ë¥˜ ì—†ìŒ |

#### 1.3 `db_refactoring/postgres/001_initial_schema.sql` ì •ë¦¬

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ë¤í”„ íŒŒì¼ ì •ë¦¬ (ì£¼ì„ ì¶”ê°€, ìˆœì„œ ì •ë ¬, ë¶ˆí•„ìš” ë‚´ìš© ì œê±°) |
| ì™„ë£Œ ê¸°ì¤€ | ê¹”ë”í•˜ê²Œ ì •ë¦¬ëœ ìŠ¤í‚¤ë§ˆ íŒŒì¼ |

#### 1.4 `db_refactoring/postgres/002_seed_data.sql` ìƒì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | coverage_category, disease_code_set ë“± ì´ˆê¸° ì‹œë“œ ë°ì´í„° ì¶”ì¶œ |
| ì™„ë£Œ ê¸°ì¤€ | INSERT ë¬¸ í¬í•¨ëœ ì‹œë“œ íŒŒì¼ ìƒì„± |

#### 1.5 ìŠ¤í‚¤ë§ˆ íŒŒì¼ ê²€ì¦ (ì¬ì ìš© í…ŒìŠ¤íŠ¸)

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ë¹ˆ DBì— ìŠ¤í‚¤ë§ˆ ì¬ì ìš© í…ŒìŠ¤íŠ¸ |
| ì™„ë£Œ ê¸°ì¤€ | ì˜¤ë¥˜ ì—†ì´ ëª¨ë“  í…Œì´ë¸”/ì¸ë±ìŠ¤ ìƒì„± |

---

## Phase 1.5a: PostgreSQL ì„¤ê³„ ë¬¸ì„œ (Day 2-3)

**ëª©í‘œ**: PostgreSQL ê°œë…ì  ì„¤ê³„ ë¬¸ì„œ ìƒì„±
**ì„ í–‰ ì¡°ê±´**: Phase 1 ì™„ë£Œ
**í›„í–‰ ì‘ì—…**: Phase 3

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 1.5a.1 | `db_refactoring/scripts/generate_docs.py` ì‘ì„± | âœ… COMPLETED | 1.5 | 2025-12-13 | 2025-12-13 |
| 1.5a.2 | `db_refactoring/docs/DATA_DICTIONARY.md` ìë™ ìƒì„± | âœ… COMPLETED | 1.5a.1 | 2025-12-13 | 2025-12-13 |
| 1.5a.3 | `db_refactoring/docs/RELATIONSHIP_MAP.md` ìë™ ìƒì„± | âœ… COMPLETED | 1.5a.1 | 2025-12-13 | 2025-12-13 |
| 1.5a.4 | `db_refactoring/docs/ER_DIAGRAM.md` ìˆ˜ë™ ì‘ì„± | âœ… COMPLETED | 1.5 | 2025-12-13 | 2025-12-13 |
| 1.5a.5 | `db_refactoring/docs/DOMAIN_MODEL.md` ìˆ˜ë™ ì‘ì„± | âœ… COMPLETED | 1.5 | 2025-12-13 | 2025-12-13 |

### Task ìƒì„¸

#### 1.5a.1 `db_refactoring/scripts/generate_docs.py` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | DB ìŠ¤í‚¤ë§ˆì—ì„œ ë°ì´í„° ë”•ì…”ë„ˆë¦¬, ê´€ê³„ ë¬¸ì„œ ìë™ ìƒì„± ìŠ¤í¬ë¦½íŠ¸ |
| ì™„ë£Œ ê¸°ì¤€ | ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œ ë¬¸ì„œ ìë™ ìƒì„± |

#### 1.5a.2-3 ìë™ ìƒì„± ë¬¸ì„œ

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | generate_docs.py ì‹¤í–‰í•˜ì—¬ DATA_DICTIONARY.md, RELATIONSHIP_MAP.md ìƒì„± |
| ì™„ë£Œ ê¸°ì¤€ | 15ê°œ í…Œì´ë¸” ëª¨ë‘ ë¬¸ì„œí™” |

#### 1.5a.4 `db_refactoring/docs/ER_DIAGRAM.md` ìˆ˜ë™ ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | Mermaid ê¸°ë°˜ E-R ë‹¤ì´ì–´ê·¸ë¨ ì‘ì„± |
| ì™„ë£Œ ê¸°ì¤€ | ì „ì²´ êµ¬ì¡° + ë„ë©”ì¸ë³„ ìƒì„¸ ë‹¤ì´ì–´ê·¸ë¨ |

#### 1.5a.5 `db_refactoring/docs/DOMAIN_MODEL.md` ìˆ˜ë™ ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ ì„¤ëª… ë¬¸ì„œ |
| ì™„ë£Œ ê¸°ì¤€ | ë³´í—˜/ë¬¸ì„œ/ë§¤í•‘ ë„ë©”ì¸ ì„¤ëª… ì™„ë£Œ |

---

## Phase 1.5b: Neo4j ì„¤ê³„ ë¬¸ì„œ (Day 2-3)

**ëª©í‘œ**: Neo4j ê·¸ë˜í”„ ê°œë…ì  ì„¤ê³„ ë¬¸ì„œ ìƒì„±
**ì„ í–‰ ì¡°ê±´**: Phase 1 ì™„ë£Œ
**í›„í–‰ ì‘ì—…**: Phase 4

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 1.5b.1 | `db_refactoring/docs/GRAPH_SCHEMA.md` ì‘ì„± | âœ… COMPLETED | 1.5 | 2025-12-13 | 2025-12-13 |
| 1.5b.2 | `db_refactoring/docs/NODE_DICTIONARY.md` ì‘ì„± | âœ… COMPLETED | 1.5 | 2025-12-13 | 2025-12-13 |
| 1.5b.3 | `db_refactoring/docs/RELATIONSHIP_DICTIONARY.md` ì‘ì„± | âœ… COMPLETED | 1.5 | 2025-12-13 | 2025-12-13 |
| 1.5b.4 | `db_refactoring/docs/GRAPH_PATTERNS.md` ì‘ì„± | âœ… COMPLETED | 1.5b.2, 1.5b.3 | 2025-12-13 | 2025-12-13 |
| 1.5b.5 | `db_refactoring/docs/ONTOLOGY_GAP_ANALYSIS.md` ì‘ì„± | âœ… COMPLETED | 1.5b.1 | 2025-12-13 | 2025-12-13 |

### Task ìƒì„¸

#### 1.5b.1 `db_refactoring/docs/GRAPH_SCHEMA.md` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | Neo4j ê·¸ë˜í”„ ëª¨ë¸ ê°œìš”, ì„¤ê³„ ì›ì¹™, í˜„ì¬ ìƒíƒœ (640ë…¸ë“œ, 623ê´€ê³„) |
| ì™„ë£Œ ê¸°ì¤€ | ê·¸ë˜í”„ ëª¨ë¸ ì„¤ê³„ ë¬¸ì„œ ì™„ì„± |

#### 1.5b.2 `db_refactoring/docs/NODE_DICTIONARY.md` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | 8ê°œ ë…¸ë“œ ë ˆì´ë¸”ë³„ ì†ì„± ì •ì˜ (Company, Product, Coverage, Benefit ë“±) |
| ì™„ë£Œ ê¸°ì¤€ | ëª¨ë“  ë…¸ë“œ ì†ì„± ë¬¸ì„œí™” |

#### 1.5b.3 `db_refactoring/docs/RELATIONSHIP_DICTIONARY.md` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | 6ê°œ ê´€ê³„ íƒ€ì… ì •ì˜ (HAS_PRODUCT, OFFERS, HAS_BENEFIT ë“±) |
| ì™„ë£Œ ê¸°ì¤€ | ëª¨ë“  ê´€ê³„ ì¹´ë””ë„ë¦¬í‹°, ë°©í–¥ì„± ë¬¸ì„œí™” |

#### 1.5b.4 `db_refactoring/docs/GRAPH_PATTERNS.md` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ìì£¼ ì‚¬ìš©ë˜ëŠ” Cypher ì¿¼ë¦¬ íŒ¨í„´ |
| ì™„ë£Œ ê¸°ì¤€ | ê¸°ë³¸ ì¡°íšŒ, ê³„ì¸µ íƒìƒ‰, ë¹„êµ ë¶„ì„ íŒ¨í„´ ë¬¸ì„œí™” |

#### 1.5b.5 `db_refactoring/docs/ONTOLOGY_GAP_ANALYSIS.md` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ontology_concept.md ëŒ€ë¹„ í˜„ì¬ êµ¬í˜„ ê°­ ë¶„ì„ |
| ì™„ë£Œ ê¸°ì¤€ | ë¯¸êµ¬í˜„ ë…¸ë“œ(RiskEvent, Condition ë“±), ë¯¸êµ¬í˜„ ê´€ê³„ ëª©ë¡í™” |

---

## Phase 2: Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ ë„ì… (Day 4-5)

**ëª©í‘œ**: Alembicì„ ì‚¬ìš©í•œ ë§ˆì´ê·¸ë ˆì´ì…˜ ë²„ì „ ê´€ë¦¬ ì²´ê³„ ìˆ˜ë¦½
**ì„ í–‰ ì¡°ê±´**: Phase 1 ì™„ë£Œ
**í›„í–‰ ì‘ì—…**: Phase 3

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 2.1 | Alembic ì„¤ì¹˜ | âœ… COMPLETED | 1.5 | 2025-12-13 | 2025-12-13 |
| 2.2 | Alembic ì´ˆê¸°í™” (`alembic init`) | âœ… COMPLETED | 2.1 | 2025-12-13 | 2025-12-13 |
| 2.3 | `alembic.ini` ì„¤ì • | âœ… COMPLETED | 2.2 | 2025-12-13 | 2025-12-13 |
| 2.4 | `env.py` í™˜ê²½ë³€ìˆ˜ ì„¤ì • | âœ… COMPLETED | 2.3 | 2025-12-13 | 2025-12-13 |
| 2.5 | ì´ˆê¸° ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„± (001_initial) | âœ… COMPLETED | 2.4 | 2025-12-13 | 2025-12-13 |
| 2.6 | ì˜ˆì‹œ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„± (002_example) | âœ… COMPLETED | 2.5 | 2025-12-13 | 2025-12-13 |
| 2.7 | ë§ˆì´ê·¸ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸ (upgrade/downgrade) | âœ… COMPLETED | 2.6 | 2025-12-13 | 2025-12-13 |

### Task ìƒì„¸

#### 2.1 Alembic ì„¤ì¹˜

| í•­ëª© | ë‚´ìš© |
|------|------|
| ëª…ë ¹ì–´ | `pip install alembic` |
| ì™„ë£Œ ê¸°ì¤€ | `alembic --version` ì‹¤í–‰ ì„±ê³µ |

#### 2.2-2.4 Alembic ì´ˆê¸°í™” ë° ì„¤ì •

| í•­ëª© | ë‚´ìš© |
|------|------|
| ëª…ë ¹ì–´ | `cd db_refactoring && alembic init migrations` |
| ì„¤ì • | `alembic.ini`ì— sqlalchemy.url ì„¤ì •, `env.py`ì— í™˜ê²½ë³€ìˆ˜ ë¡œë“œ |

#### 2.5-2.6 ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ì´ˆê¸° ìŠ¤í‚¤ë§ˆ ë° ê¸°ì¡´ SQL ë§ˆì´ê·¸ë ˆì´ì…˜ì„ Alembic í˜•ì‹ìœ¼ë¡œ ë³€í™˜ |
| ì™„ë£Œ ê¸°ì¤€ | `alembic upgrade head` ì„±ê³µ |

#### 2.7 ë§ˆì´ê·¸ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | upgrade/downgrade ì–‘ë°©í–¥ í…ŒìŠ¤íŠ¸ |
| ì™„ë£Œ ê¸°ì¤€ | ë¡¤ë°± í›„ ì¬ì ìš© ì„±ê³µ |

---

## Phase 2.5: DB ì „í™˜ (Test â†’ Production) âœ… ì™„ë£Œ

**ëª©í‘œ**: í…ŒìŠ¤íŠ¸ DB(15432)ë¥¼ ìƒˆ ìš´ì˜ DBë¡œ ì „í™˜
**ì„ í–‰ ì¡°ê±´**: Phase 2 ì™„ë£Œ
**í›„í–‰ ì‘ì—…**: Phase 3
**ì°¸ì¡° ë¬¸ì„œ**: [task_upgrade.md](./task_upgrade.md)

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 2.5.1 | `.env` íŒŒì¼ ìƒì„± ë° í™˜ê²½ ì„¤ì • | âœ… COMPLETED | 2.7 | 2025-12-13 | 2025-12-13 |
| 2.5.2 | í•˜ë“œì½”ë”© URL ì œê±° (16ê°œ íŒŒì¼) | âœ… COMPLETED | 2.5.1 | 2025-12-13 | 2025-12-13 |
| 2.5.3 | `load_dotenv()` í‘œì¤€í™” | âœ… COMPLETED | 2.5.1 | 2025-12-13 | 2025-12-13 |
| 2.5.4 | PostgreSQL ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ | âœ… COMPLETED | 2.5.2 | 2025-12-13 | 2025-12-13 |
| 2.5.5 | Neo4j ë™ê¸°í™” (graph_loader.py) | âœ… COMPLETED | 2.5.4 | 2025-12-13 | 2025-12-13 |
| 2.5.6 | ì—°ê²° í…ŒìŠ¤íŠ¸ ë° ê²€ì¦ | âœ… COMPLETED | 2.5.5 | 2025-12-13 | 2025-12-13 |

### Task ìƒì„¸

#### 2.5.1 `.env` íŒŒì¼ ìƒì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env` íŒŒì¼ ìƒì„±, ìƒˆ DB ì—°ê²° ì •ë³´ ì •ì˜ |
| ê²°ê³¼ | PostgreSQL: 15432, Neo4j: 17687 |

#### 2.5.2 í•˜ë“œì½”ë”© URL ì œê±°

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | `localhost:5432` fallback ì œê±°, í™˜ê²½ë³€ìˆ˜ í•„ìˆ˜í™” |
| ìˆ˜ì • íŒŒì¼ | 16ê°œ (ingestion/6, vector_index/2, retrieval/2, ontology/1, api/3, scripts/2) |

#### 2.5.3 `load_dotenv()` í‘œì¤€í™”

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ëª¨ë“  íŒŒì¼ì— `from dotenv import load_dotenv; load_dotenv()` ì¶”ê°€ |
| ì™„ë£Œ ê¸°ì¤€ | í™˜ê²½ë³€ìˆ˜ ì—†ì„ ì‹œ ëª…í™•í•œ ì—ëŸ¬ ë°œìƒ |

#### 2.5.4 PostgreSQL ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | pg_dump â†’ ìƒˆ DB ì ìš© (ì„ë² ë”© ì œì™¸) |
| ê²°ê³¼ | document: 38, document_clause: 134,844, coverage: 363, benefit: 357 |

#### 2.5.5 Neo4j ë™ê¸°í™”

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | `python -m ingestion.graph_loader --all` ì‹¤í–‰ |
| ê²°ê³¼ | 918 nodes, 949 relationships |

#### 2.5.6 ì—°ê²° í…ŒìŠ¤íŠ¸

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | PostgreSQL, Neo4j ì—°ê²° ë° ë°ì´í„° ê²€ì¦ |
| ê²°ê³¼ | ëª¨ë“  ì—°ê²° ì •ìƒ, ë°ì´í„° ì¼ì¹˜ í™•ì¸ |

### ìƒˆ ìš´ì˜ í™˜ê²½

| í•­ëª© | ê°’ |
|------|-----|
| PostgreSQL URL | `postgresql://postgres:postgres@127.0.0.1:15432/insurance_ontology_test` |
| Neo4j URI | `bolt://127.0.0.1:17687` |
| í™˜ê²½ ì„¤ì • íŒŒì¼ | `.env` |

### ë‚¨ì€ ì„ íƒ ì‘ì—…

| Task | ëª…ë ¹ì–´ | ì„¤ëª… |
|------|--------|------|
| ì„ë² ë”© ì¬ìƒì„± | `python -m vector_index.build_index` | âœ… ì™„ë£Œ (2025-12-14) |
| QA í…ŒìŠ¤íŠ¸ | `python scripts/evaluate_qa.py` | 86% ì •í™•ë„ ëª©í‘œ |

---

## Phase 3: ìŠ¤í¬ë¦½íŠ¸ ë° ê²€ì¦ ë„êµ¬ (Day 6-7) âœ… ì™„ë£Œ

**ëª©í‘œ**: DB ì´ˆê¸°í™”, ë§ˆì´ê·¸ë ˆì´ì…˜, ìŠ¤í‚¤ë§ˆ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
**ì„ í–‰ ì¡°ê±´**: Phase 1.5a, Phase 2 ì™„ë£Œ
**í›„í–‰ ì‘ì—…**: Phase 6

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 3.1 | `db_refactoring/scripts/init_db.sh` ì‘ì„± | âœ… COMPLETED | 2.7 | 2025-12-13 | 2025-12-13 |
| 3.2 | `db_refactoring/scripts/verify_schema.py` ì‘ì„± | âœ… COMPLETED | 1.5a.5 | 2025-12-13 | 2025-12-13 |
| 3.3 | `db_refactoring/scripts/migrate.sh` ì‘ì„± | âœ… COMPLETED | 2.7 | 2025-12-13 | 2025-12-13 |
| 3.4 | ë¡œì»¬ í™˜ê²½ ì „ì²´ í…ŒìŠ¤íŠ¸ | âœ… COMPLETED | 3.1, 3.2, 3.3 | 2025-12-13 | 2025-12-13 |

### Task ìƒì„¸

#### 3.1 `db_refactoring/scripts/init_db.sh` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ìŠ¤í‚¤ë§ˆ ìƒì„± + ì‹œë“œ ë°ì´í„° ì ì¬ + Alembic ìŠ¤íƒ¬í”„ |
| ì™„ë£Œ ê¸°ì¤€ | ë¹ˆ DBì—ì„œ ì „ì²´ ì´ˆê¸°í™” ì„±ê³µ |

#### 3.2 `db_refactoring/scripts/verify_schema.py` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | í˜„ì¬ DB ìŠ¤í‚¤ë§ˆê°€ ì •ì˜ëœ ìŠ¤í‚¤ë§ˆì™€ ì¼ì¹˜í•˜ëŠ”ì§€ ê²€ì¦ |
| ì™„ë£Œ ê¸°ì¤€ | 15ê°œ í…Œì´ë¸”, 52ê°œ ì¸ë±ìŠ¤, pgvector í™•ì¥ ê²€ì¦ |

#### 3.3 `db_refactoring/scripts/migrate.sh` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | upgrade/downgrade/history/current ëª…ë ¹ ë˜í¼ |
| ì™„ë£Œ ê¸°ì¤€ | ëª¨ë“  ë§ˆì´ê·¸ë ˆì´ì…˜ ëª…ë ¹ ë™ì‘ |

#### 3.4 ë¡œì»¬ í™˜ê²½ ì „ì²´ í…ŒìŠ¤íŠ¸

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | init_db.sh â†’ verify_schema.py â†’ migrate.sh ìˆœì°¨ ì‹¤í–‰ |
| ì™„ë£Œ ê¸°ì¤€ | ì „ì²´ ì›Œí¬í”Œë¡œìš° ì˜¤ë¥˜ ì—†ìŒ |

---

## Phase 4: Neo4j ìŠ¤í‚¤ë§ˆ ê´€ë¦¬ (Day 8-9) âœ… ì™„ë£Œ

**ëª©í‘œ**: Neo4j ê·¸ë˜í”„ ìŠ¤í‚¤ë§ˆ ì •ì˜ ë° PostgreSQL ë™ê¸°í™” ê²€ì¦
**ì„ í–‰ ì¡°ê±´**: Phase 1.5b ì™„ë£Œ
**í›„í–‰ ì‘ì—…**: Phase 7

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 4.1 | `db_refactoring/neo4j/001_graph_schema.cypher` ìƒì„± | âœ… COMPLETED | 1.5b.3 | 2025-12-13 | 2025-12-13 |
| 4.2 | `db_refactoring/scripts/init_neo4j.sh` ì‘ì„± | âœ… COMPLETED | 4.1 | 2025-12-13 | 2025-12-13 |
| 4.3 | `db_refactoring/scripts/verify_neo4j_sync.py` ì‘ì„± | âœ… COMPLETED | 4.1 | 2025-12-13 | 2025-12-13 |
| 4.4 | PostgreSQL â†” Neo4j ë™ê¸°í™” ê²€ì¦ ì‹¤í–‰ | âœ… COMPLETED | 4.3 | 2025-12-13 | 2025-12-13 |
| 4.5 | `graph_loader.py`ì— PARENT_OF ê´€ê³„ ì¶”ê°€ | âœ… COMPLETED | 4.4 | 2025-12-13 | 2025-12-13 |

### Task ìƒì„¸

#### 4.1 `db_refactoring/neo4j/001_graph_schema.cypher` ìƒì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ì œì•½ì¡°ê±´ (UNIQUE), ì¸ë±ìŠ¤, ë…¸ë“œ/ê´€ê³„ ìŠ¤í‚¤ë§ˆ ì •ì˜ |
| ì™„ë£Œ ê¸°ì¤€ | cypher-shellë¡œ ì‹¤í–‰ ê°€ëŠ¥ |

#### 4.2 `db_refactoring/scripts/init_neo4j.sh` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | Neo4j ì´ˆê¸°í™” + graph_loader.py í˜¸ì¶œ |
| ì™„ë£Œ ê¸°ì¤€ | ë¹ˆ Neo4jì—ì„œ ì „ì²´ ë™ê¸°í™” ì„±ê³µ |

#### 4.3 `db_refactoring/scripts/verify_neo4j_sync.py` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | PostgreSQLê³¼ Neo4j ê°„ ì—”í‹°í‹° ìˆ˜ ì¼ì¹˜ ê²€ì¦ |
| ì™„ë£Œ ê¸°ì¤€ | 5ê°œ ì—”í‹°í‹° íƒ€ì… ìˆ˜ëŸ‰ ì¼ì¹˜ í™•ì¸ |

#### 4.4 ë™ê¸°í™” ê²€ì¦ ì‹¤í–‰

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | verify_neo4j_sync.py ì‹¤í–‰ |
| ì™„ë£Œ ê¸°ì¤€ | Company(8), Product(8), Coverage(363), Benefit(357) ë“± ì¼ì¹˜ |

#### 4.5 (ì„ íƒ) PARENT_OF ê´€ê³„ ì¶”ê°€

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | graph_loader.pyì— Coverage ê³„ì¸µ ê´€ê³„ ì¶”ê°€ |
| ì™„ë£Œ ê¸°ì¤€ | 52ê°œ ìì‹ ë‹´ë³´ì— PARENT_OF ê´€ê³„ ìƒì„± |

---

## Phase 5: pgvector ì¸ë±ìŠ¤ ê´€ë¦¬ (Day 10-11) âœ… ì™„ë£Œ

**ëª©í‘œ**: pgvector ì¸ë±ìŠ¤ ì„¤ì • ë¬¸ì„œí™” ë° ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë„êµ¬ ì‘ì„±
**ì„ í–‰ ì¡°ê±´**: Phase 1 ì™„ë£Œ (ë…ë¦½ì  ì§„í–‰ ê°€ëŠ¥)
**í›„í–‰ ì‘ì—…**: ì—†ìŒ

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 5.1 | `db_refactoring/postgres/003_pgvector_setup.sql` ìƒì„± | âœ… COMPLETED | 1.5 | 2025-12-14 | 2025-12-14 |
| 5.2 | HNSW ì¸ë±ìŠ¤ íŒŒë¼ë¯¸í„° ê°€ì´ë“œ ë¬¸ì„œí™” | âœ… COMPLETED | 5.1 | 2025-12-14 | 2025-12-14 |
| 5.3 | `db_refactoring/scripts/monitor_vector_search.py` ì‘ì„± | âœ… COMPLETED | 5.1 | 2025-12-14 | 2025-12-14 |
| 5.4 | ì„ë² ë”© ëª¨ë¸ ë³€ê²½ ë§ˆì´ê·¸ë ˆì´ì…˜ í…œí”Œë¦¿ ì‘ì„± | âœ… COMPLETED | 5.2 | 2025-12-14 | 2025-12-14 |
| 5.5 | ë²¡í„° ê²€ìƒ‰ ë²¤ì¹˜ë§ˆí¬ ì‹¤í–‰ ë° ê¸°ì¤€ì„  ìˆ˜ë¦½ | âœ… COMPLETED | 5.3 | 2025-12-14 | 2025-12-14 |

### Task ìƒì„¸

#### 5.1 `db_refactoring/postgres/003_pgvector_setup.sql` ìƒì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | pgvector í™•ì¥ ì„¤ì¹˜, ë²¡í„° í…Œì´ë¸”, HNSW ì¸ë±ìŠ¤ ì •ì˜ |
| ì™„ë£Œ ê¸°ì¤€ | ë…ë¦½ ì‹¤í–‰ ê°€ëŠ¥í•œ pgvector ì„¤ì • íŒŒì¼ |

#### 5.2 HNSW ì¸ë±ìŠ¤ íŒŒë¼ë¯¸í„° ê°€ì´ë“œ

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | m, ef_construction, ef_search íŒŒë¼ë¯¸í„° íŠœë‹ ê°€ì´ë“œ |
| ì™„ë£Œ ê¸°ì¤€ | ë°ì´í„° ê·œëª¨ë³„ ê¶Œì¥ê°’ ë¬¸ì„œí™” |

#### 5.3 `db_refactoring/scripts/monitor_vector_search.py` ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ë²¡í„° ê²€ìƒ‰ ë²¤ì¹˜ë§ˆí¬ ë° ì¸ë±ìŠ¤ í†µê³„ ì¡°íšŒ |
| ì™„ë£Œ ê¸°ì¤€ | ê²€ìƒ‰ ì§€ì—°ì‹œê°„, recall ì¸¡ì • ê¸°ëŠ¥ |

#### 5.4 ì„ë² ë”© ëª¨ë¸ ë³€ê²½ ë§ˆì´ê·¸ë ˆì´ì…˜ í…œí”Œë¦¿

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ì„ë² ë”© ëª¨ë¸ ë³€ê²½ ì‹œ ì ˆì°¨ í…œí”Œë¦¿ |
| ì™„ë£Œ ê¸°ì¤€ | ë‹¨ê³„ë³„ ì²´í¬ë¦¬ìŠ¤íŠ¸ ë¬¸ì„œí™” |

#### 5.5 ë²¡í„° ê²€ìƒ‰ ë²¤ì¹˜ë§ˆí¬

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | í˜„ì¬ ì„±ëŠ¥ ì¸¡ì • ë° ê¸°ì¤€ì„  ê¸°ë¡ |
| ì™„ë£Œ ê¸°ì¤€ | 134,644ê±´ ê¸°ì¤€ ê²€ìƒ‰ ì„±ëŠ¥ ê¸°ë¡ |

---

## Phase 6: CI/CD í†µí•© (Day 12)

**ëª©í‘œ**: GitHub Actionsë¥¼ í†µí•œ ìë™ ìŠ¤í‚¤ë§ˆ ê²€ì¦
**ì„ í–‰ ì¡°ê±´**: Phase 3 ì™„ë£Œ
**í›„í–‰ ì‘ì—…**: ì—†ìŒ

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 6.1 | `.github/workflows/schema-check.yml` ì‘ì„± | â¬œ PENDING | 3.4 | - | - |
| 6.2 | PR í…ŒìŠ¤íŠ¸ (ìë™ ê²€ì¦ í™•ì¸) | â¬œ PENDING | 6.1 | - | - |
| 6.3 | ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ ë¬¸ì„œ ì‘ì„± | âœ… COMPLETED | 6.2 | 2025-12-14 | 2025-12-14 |

### Task ìƒì„¸

#### 6.1 GitHub Actions ì›Œí¬í”Œë¡œìš° ì‘ì„±

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | pgvector ì´ë¯¸ì§€ ê¸°ë°˜ í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œ ìŠ¤í‚¤ë§ˆ ê²€ì¦ |
| ì™„ë£Œ ê¸°ì¤€ | db/, ingestion/ ë³€ê²½ ì‹œ ìë™ ì‹¤í–‰ |

#### 6.2 PR í…ŒìŠ¤íŠ¸

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | í…ŒìŠ¤íŠ¸ PR ìƒì„±í•˜ì—¬ ì›Œí¬í”Œë¡œìš° ë™ì‘ í™•ì¸ |
| ì™„ë£Œ ê¸°ì¤€ | ì„±ê³µ/ì‹¤íŒ¨ ì¼€ì´ìŠ¤ ëª¨ë‘ ê²€ì¦ |

#### 6.3 ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ ë¬¸ì„œ

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ê°œë°œììš© ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì„±/ì ìš© ê°€ì´ë“œ |
| ì™„ë£Œ ê¸°ì¤€ | README ë˜ëŠ” ë³„ë„ ë¬¸ì„œ ì‘ì„± |

---

## Phase 7: ì˜¨í†¨ë¡œì§€ í™•ì¥ (Day 13-15) âœ… ì™„ë£Œ

**ëª©í‘œ**: ontology_concept.md ê¸°ë°˜ Neo4j ìŠ¤í‚¤ë§ˆ í™•ì¥
**ì„ í–‰ ì¡°ê±´**: Phase 4 ì™„ë£Œ
**í›„í–‰ ì‘ì—…**: ì—†ìŒ

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 7.1 | PostgreSQLì— `risk_event` í…Œì´ë¸” ì„¤ê³„ | âœ… COMPLETED | 4.4 | 2025-12-13 | 2025-12-13 |
| 7.2 | PostgreSQLì— `condition` í…Œì´ë¸” ì„¤ê³„ | âœ… COMPLETED (ê¸°ì¡´) | 4.4 | - | - |
| 7.3 | PostgreSQLì— `exclusion` í…Œì´ë¸” ì„¤ê³„ | âœ… COMPLETED (ê¸°ì¡´) | 4.4 | - | - |
| 7.4 | Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì„± (ontology_extension) | âœ… COMPLETED | 7.1 | 2025-12-13 | 2025-12-13 |
| 7.5 | Neo4jì— RiskEvent ë…¸ë“œ ì¶”ê°€ | âœ… COMPLETED | 7.4 | 2025-12-13 | 2025-12-13 |
| 7.6 | Neo4jì— Condition ë…¸ë“œ ì¶”ê°€ | âœ… COMPLETED | 7.4 | 2025-12-13 | 2025-12-13 |
| 7.7 | Neo4jì— Exclusion ë…¸ë“œ ì¶”ê°€ | âœ… COMPLETED | 7.4 | 2025-12-13 | 2025-12-13 |
| 7.8 | graph_loader.py í™•ì¥ | âœ… COMPLETED | 7.5, 7.6, 7.7 | 2025-12-13 | 2025-12-13 |
| 7.9 | (ì„ íƒ) Plan ë…¸ë“œ ì„¤ê³„ ë° ì¶”ê°€ | âœ… COMPLETED | 7.8 | 2025-12-13 | 2025-12-13 |

### Task ìƒì„¸

#### 7.1-7.3 ìƒˆ í…Œì´ë¸” ì„¤ê³„

| í•­ëª© | ë‚´ìš© |
|------|------|
| risk_event | event_type, event_name, severity_level, icd_code_pattern |
| condition | condition_type, value, unit, description |
| exclusion | exclusion_type, description, clause_reference |

#### 7.4 Alembic ë§ˆì´ê·¸ë ˆì´ì…˜

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ìƒˆ í…Œì´ë¸” ë° ê´€ê³„ ìƒì„± ë§ˆì´ê·¸ë ˆì´ì…˜ |
| ì™„ë£Œ ê¸°ì¤€ | upgrade/downgrade ëª¨ë‘ ì‘ë™ |

#### 7.5-7.7 Neo4j ë…¸ë“œ ì¶”ê°€

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | RiskEvent, Condition, Exclusion ë…¸ë“œ ë° ê´€ê³„ ì¶”ê°€ |
| ê´€ê³„ | TRIGGERS (Benefitâ†’RiskEvent), HAS_CONDITION, HAS_EXCLUSION |

#### 7.8 graph_loader.py í™•ì¥

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ìƒˆ ì—”í‹°í‹° ë™ê¸°í™” ë¡œì§ ì¶”ê°€ |
| ì™„ë£Œ ê¸°ì¤€ | --sync-risk-events, --sync-conditions, --sync-exclusions ì˜µì…˜ |

#### 7.9 (ì„ íƒ) Plan ë…¸ë“œ âœ… ì™„ë£Œ

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ê°€ì…ì„¤ê³„ì„œ íŒŒì‹± ì—°ë™ í›„ Plan ë…¸ë“œ ì¶”ê°€ |
| ì™„ë£Œ ê¸°ì¤€ | Plan â†’ Coverage INCLUDES ê´€ê³„ ìƒì„± |
| ì™„ë£Œ ë‚´ìš© | PostgreSQL: plan, plan_coverage í…Œì´ë¸”, Neo4j: Plan ë…¸ë“œ/ì¸ë±ìŠ¤, graph_loader.py sync_plans() |

---

## Phase 8: ê²€ìƒ‰ ì‹œìŠ¤í…œ (Day 16-17)

**ëª©í‘œ**: í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ ì‹œìŠ¤í…œ êµ¬ì¶• ë° í…ŒìŠ¤íŠ¸
**ì„ í–‰ ì¡°ê±´**: Phase 5 ì™„ë£Œ (ì„ë² ë”© ìƒì„±)
**í›„í–‰ ì‘ì—…**: Phase 9 (API ê°œë°œ)

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 8.1 | NL Mapper í…ŒìŠ¤íŠ¸ | âœ… COMPLETED | 5.5 | 2025-12-14 | 2025-12-14 |
| 8.2 | Vector Retriever í…ŒìŠ¤íŠ¸ | âœ… COMPLETED | 5.5 | 2025-12-14 | 2025-12-14 |
| 8.3 | Hybrid Retriever í…ŒìŠ¤íŠ¸ | âœ… COMPLETED | 8.1, 8.2 | 2025-12-14 | 2025-12-14 |
| 8.4 | Context Assembly í…ŒìŠ¤íŠ¸ | âœ… COMPLETED | 8.3 | 2025-12-14 | 2025-12-14 |

### Task ìƒì„¸

#### 8.1 NL Mapper í…ŒìŠ¤íŠ¸

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ìì—°ì–´ â†’ ì—”í‹°í‹° ë§¤í•‘ í…ŒìŠ¤íŠ¸ |
| ì™„ë£Œ ê¸°ì¤€ | íšŒì‚¬ëª…, ìƒí’ˆëª…, ë‹´ë³´ëª… ì¸ì‹ ì •ìƒ ë™ì‘ |

#### 8.2 Vector Retriever í…ŒìŠ¤íŠ¸

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | ë²¡í„° ê²€ìƒ‰ ë™ì‘ í™•ì¸ |
| ì™„ë£Œ ê¸°ì¤€ | ìœ ì‚¬ ì¡°í•­ ê²€ìƒ‰ ì •ìƒ ë™ì‘ |

#### 8.3 Hybrid Retriever í…ŒìŠ¤íŠ¸

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | í†µí•© ê²€ìƒ‰ (NL + Vector) í…ŒìŠ¤íŠ¸ |
| í…ŒìŠ¤íŠ¸ ì½”ë“œ | `retrieval.hybrid_retriever.HybridRetriever` |
| ì™„ë£Œ ê¸°ì¤€ | ë³µí•© ì¿¼ë¦¬ ("ì‚¼ì„± ì•”ì§„ë‹¨ë¹„ 3000ë§Œì›") ì •ìƒ ë™ì‘ |

#### 8.4 Context Assembly í…ŒìŠ¤íŠ¸

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | LLM ì»¨í…ìŠ¤íŠ¸ ìƒì„± í…ŒìŠ¤íŠ¸ |
| ì™„ë£Œ ê¸°ì¤€ | ê²€ìƒ‰ ê²°ê³¼ â†’ í”„ë¡¬í”„íŠ¸ ì¡°ë¦½ ì •ìƒ ë™ì‘ |

---

## Phase 9: ì—”í‹°í‹° ì¶”ì¶œ íŒŒì´í”„ë¼ì¸ (Day 18)

**ëª©í‘œ**: PDFì—ì„œ ì—”í‹°í‹° ì¶”ì¶œ ë° DB ì €ì¥
**ì„ í–‰ ì¡°ê±´**: Phase 7 ì™„ë£Œ (ì˜¨í†¨ë¡œì§€ í™•ì¥)
**í›„í–‰ ì‘ì—…**: ë°ì´í„° í’ˆì§ˆ ê°œì„ 

| ID | Task | ìƒíƒœ | ì„ í–‰ | ì‹œì‘ì¼ | ì™„ë£Œì¼ |
|----|------|------|------|--------|--------|
| 9.1 | Coverage í•„í„° ê°œì„  | âœ… COMPLETED | 7.9 | 2025-12-14 | 2025-12-14 |
| 9.2 | ìŠ¤í‚¤ë§ˆ í†µí•© (r1â†’v3) | âœ… COMPLETED | 9.1 | 2025-12-14 | 2025-12-14 |
| 9.3 | proposal_plan_extractor.py | âœ… COMPLETED | 9.2 | 2025-12-14 | 2025-12-14 |
| 9.4 | risk_event_extractor.py | âœ… COMPLETED | 9.2 | 2025-12-14 | 2025-12-14 |
| 9.5 | exclusion/condition_extractor.py | âœ… COMPLETED | 9.2 | 2025-12-14 | 2025-12-14 |
| 9.6 | clause_number ì¶”ì¶œ ìˆ˜ì • | âœ… COMPLETED | 9.1 | 2025-12-14 | 2025-12-14 |
| 9.7 | ë¬¸ì„œí™” (í’ˆì§ˆ ê°œì„ , ì„¸ì…˜ ìš”ì•½) | âœ… COMPLETED | 9.5 | 2025-12-14 | 2025-12-14 |
| 9.8 | ë¬¸ì„œí™” (í…Œì´ë¸” ì»¬ëŸ¼ ë ˆí¼ëŸ°ìŠ¤) | âœ… COMPLETED | 9.7 | 2025-12-14 | 2025-12-14 |
| 9.9 | ë¬¸ì„œ ë³‘í•©/ì •ë¦¬ | âœ… COMPLETED | 9.8 | 2025-12-14 | 2025-12-14 |

### Task ìƒì„¸

#### 9.1 Coverage í•„í„° ê°œì„ 

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | `base_parser.py`ì˜ `is_valid_coverage_name()` ë…¸ì´ì¦ˆ í•„í„° ì¶”ê°€ |
| í•„í„° | ë„ì–´ì“°ê¸° ë¹„ìœ¨ >25%, ê¹¨ì§„ í•œê¸€, í”Œëœ íƒ€ì…, (ê¸‰ì—¬) suffix, ë²•ë¥ ë¹„ìš© |
| ê²°ê³¼ | 533ê°œ â†’ 294ê°œ (45% ë…¸ì´ì¦ˆ ì œê±°) |

#### 9.2 ìŠ¤í‚¤ë§ˆ í†µí•© (r1â†’v3)

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | r1 ìŠ¤í‚¤ë§ˆì˜ 4ê°œ í…Œì´ë¸”ì„ v3ì— ì ìš© |
| í…Œì´ë¸” | plan, plan_coverage, risk_event, benefit_risk_event |
| íŒŒì¼ | `001_initial_schema.sql` êµì²´ |

#### 9.3 proposal_plan_extractor.py

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | proposal ë¬¸ì„œì—ì„œ Plan/PlanCoverage ì¶”ì¶œ |
| ê²°ê³¼ | 10ê°œ Plan, 571ê°œ plan_coverage |
| íŒ¨í„´ ì²˜ë¦¬ | íšŒì‚¬ë³„ (Samsung: ê³µë°±, Hyundai: ì—°ê²°, Lotte: ì—­ìˆœ) |

#### 9.4 risk_event_extractor.py

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | terms ë¬¸ì„œì—ì„œ ìœ„í—˜ ì´ë²¤íŠ¸ ì¶”ì¶œ |
| ê²°ê³¼ | 572ê°œ risk_event (cancer 220, treatment 106, hospitalization 84...) |
| ì¶”ì¶œ íŒ¨í„´ | ì •ì˜ ì¡°í•­, ICD ì½”ë“œ (C73, I63 ë“±) |

#### 9.5 exclusion/condition_extractor.py

| í•­ëª© | ë‚´ìš© |
|------|------|
| ì„¤ëª… | terms ë¬¸ì„œì—ì„œ ë©´ì±…/ì¡°ê±´ ì¶”ì¶œ |
| ê²°ê³¼ | exclusion 28ê±´, condition 42ê±´ |
| ì¶”ì¶œ íŒ¨í„´ | "ë³´í—˜ê¸ˆì„ ì§€ê¸‰í•˜ì§€ ì•ŠëŠ” ì‚¬ìœ ", "ë³´ì¥ê°œì‹œ", "ë©´ì±…ê¸°ê°„" |

#### 9.6 clause_number ì¶”ì¶œ ìˆ˜ì •

| í•­ëª© | ë‚´ìš© |
|------|------|
| ë¬¸ì œ | coverage.clause_numberê°€ í•­ìƒ NULL |
| ì›ì¸ | `is_valid_coverage_name()`ì—ì„œ ìˆ«ì prefix í•„í„°ë§ |
| í•´ê²° | í•„í„° ë¹„í™œì„±í™”, `_clean_coverage_name()`ì—ì„œ ë¶„ë¦¬ |
| ê²°ê³¼ | 8ê°œ coverageì— clause_number ì…ë ¥ë¨ |

#### 9.7-9.9 ë¬¸ì„œí™”

| íŒŒì¼ | ë‚´ìš© |
|------|------|
| `data_quality_improvements.md` | ë°ì´í„° í’ˆì§ˆ ê°œì„  í•„ìš” í•­ëª© ë° í•´ê²°ì•ˆ |
| `table_column_reference.md` | 19ê°œ í…Œì´ë¸” ì»¬ëŸ¼ë³„ ìƒ˜í”Œê°’, ë°ì´í„° ì†ŒìŠ¤ |
| `session_20241214_summary.md` | ì‘ì—… ì„¸ì…˜ ìš”ì•½ |
| `pdf_ext.md` | pdf_ext_tasks.md ë³‘í•© |
| `parser_refact_tasks.md` | docxì—ì„œ md ìƒì„± |

---

## ì§„í–‰ ì´ë ¥

| ë‚ ì§œ | Task ID | ë³€ê²½ ë‚´ìš© | ë¹„ê³  |
|------|---------|----------|------|
| 2025-12-13 | - | task.md íŒŒì¼ ìƒì„± | ì´ˆê¸° ì‘ì—… ê³„íš ìˆ˜ë¦½ |
| 2025-12-13 | - | task.md ì¬ì‘ì„± | database_refactoring.md v2.2 ê¸°ë°˜, ì„ í›„ê´€ê³„ ë°˜ì˜ |
| 2025-12-13 | 1.1-1.4 | Phase 1 ëŒ€ë¶€ë¶„ ì™„ë£Œ | ë””ë ‰í† ë¦¬ êµ¬ì¡°, ìŠ¤í‚¤ë§ˆ ë¤í”„, SQL íŒŒì¼ ìƒì„± |
| 2025-12-13 | 1.5a.1-5 | Phase 1.5a ì™„ë£Œ | PostgreSQL ì„¤ê³„ ë¬¸ì„œ ì „ì²´ ì™„ì„± |
| 2025-12-13 | 1.5b.1-3 | Phase 1.5b ì§„í–‰ ì¤‘ | Neo4j ì„¤ê³„ ë¬¸ì„œ 3/5 ì™„ë£Œ |
| 2025-12-13 | 1.5b.4-5 | Phase 1.5b ì™„ë£Œ | GRAPH_PATTERNS.md, ONTOLOGY_GAP_ANALYSIS.md ì‘ì„± |
| 2025-12-13 | 1.5 | Phase 1 ì™„ë£Œ | ìŠ¤í‚¤ë§ˆ ê²€ì¦ (15 í…Œì´ë¸”, 52 ì¸ë±ìŠ¤, pgvector) |
| 2025-12-13 | - | ì„¤ê³„-êµ¬í˜„ ì—°ê²° ê´€ê³„ ì¶”ê°€ | ER_DIAGRAM.md, GRAPH_SCHEMA.md, task.md, docs/README.md |
| 2025-12-13 | 2.1-2.7 | Phase 2 ì™„ë£Œ | Alembic ì´ˆê¸°í™”, baseline + ì˜ˆì‹œ ë§ˆì´ê·¸ë ˆì´ì…˜, upgrade/downgrade í…ŒìŠ¤íŠ¸ |
| 2025-12-13 | 2.5.1-6 | Phase 2.5 ì™„ë£Œ | DB ì „í™˜ ì‘ì—… (Testâ†’Production), 16ê°œ íŒŒì¼ ìˆ˜ì •, ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜, Neo4j ë™ê¸°í™” |
| 2025-12-13 | 4.1-4.5 | Phase 4 ì™„ë£Œ | Neo4j ìŠ¤í‚¤ë§ˆ ê´€ë¦¬: 001_graph_schema.cypher, init_neo4j.sh, verify_neo4j_sync.py, PARENT_OF ê´€ê³„ ì¶”ê°€ (52ê°œ) |
| 2025-12-13 | 7.1-7.8 | Phase 7 ì™„ë£Œ | ì˜¨í†¨ë¡œì§€ í™•ì¥: risk_event í…Œì´ë¸”, Alembic ë§ˆì´ê·¸ë ˆì´ì…˜, Neo4j ìŠ¤í‚¤ë§ˆ í™•ì¥, graph_loader.py í™•ì¥ |
| 2025-12-13 | 7.9 | Plan ë…¸ë“œ ì™„ë£Œ | plan/plan_coverage í…Œì´ë¸”, Neo4j Plan ë…¸ë“œ/ì¸ë±ìŠ¤, sync_plans() ì¶”ê°€ |
| 2025-12-13 | 3.1-3.4 | Phase 3 ì™„ë£Œ | init_db.sh, verify_schema.py, migrate.sh ì‘ì„± ë° í…ŒìŠ¤íŠ¸ |
| 2025-12-14 | 5.1-5.5 | Phase 5 ì™„ë£Œ | 003_pgvector_setup.sql, PGVECTOR_GUIDE.md, monitor_vector_search.py, ë§ˆì´ê·¸ë ˆì´ì…˜ í…œí”Œë¦¿ |
| 2025-12-14 | - | ì„ë² ë”© ìƒì„± ì™„ë£Œ | OpenAI text-embedding-3-small, 134,844ê±´, 1.8GB |
| 2025-12-14 | 6.3 | MIGRATION_GUIDE.md ì‘ì„± | Alembic ë§ˆì´ê·¸ë ˆì´ì…˜ ê°€ì´ë“œ |
| 2025-12-14 | 8.1-8.4 | Phase 8 ì™„ë£Œ | NL Mapper, Vector/Hybrid Retriever, Context Assembly í…ŒìŠ¤íŠ¸ ì™„ë£Œ, retriever.py 1536ì°¨ì› ìˆ˜ì • |
| 2025-12-14 | 9.1 | Coverage í•„í„° ê°œì„  | base_parser.py ë…¸ì´ì¦ˆ í•„í„° ì¶”ê°€ (533â†’294ê°œ, 45% ê°ì†Œ) |
| 2025-12-14 | 9.2 | ìŠ¤í‚¤ë§ˆ í†µí•© (r1â†’v3) | plan, plan_coverage, risk_event, benefit_risk_event í…Œì´ë¸” ì¶”ê°€ |
| 2025-12-14 | 9.3 | ì—”í‹°í‹° ì¶”ì¶œê¸° êµ¬í˜„ | proposal_plan_extractor.py (10 plans, 571 plan_coverage) |
| 2025-12-14 | 9.4 | ì—”í‹°í‹° ì¶”ì¶œê¸° êµ¬í˜„ | risk_event_extractor.py (572 risk_events) |
| 2025-12-14 | 9.5 | ì—”í‹°í‹° ì¶”ì¶œê¸° êµ¬í˜„ | exclusion_extractor.py (28ê±´), condition_extractor.py (42ê±´) |
| 2025-12-14 | 9.6 | clause_number ìˆ˜ì • | ìˆ«ì prefix í•„í„° ë¹„í™œì„±í™”, _clean_coverage_name()ì—ì„œ ë¶„ë¦¬ |
| 2025-12-14 | 9.7 | ë¬¸ì„œí™” | session_20241214_summary.md, data_quality_improvements.md ì‘ì„± |
| 2025-12-14 | 9.8 | ë¬¸ì„œí™” | table_column_reference.md ì‘ì„± (19 í…Œì´ë¸” ìƒì„¸) |
| 2025-12-14 | 9.9 | ë¬¸ì„œ ì •ë¦¬ | pdf_ext.md + pdf_ext_tasks.md ë³‘í•©, parser_refact_tasks.md ìƒì„± |

---

## ì‹¤íŒ¨í•œ Task ê¸°ë¡

> ì‹¤íŒ¨í•œ ì‘ì—…ì´ ë°œìƒí•˜ë©´ ì•„ë˜ í˜•ì‹ìœ¼ë¡œ ê¸°ë¡í•©ë‹ˆë‹¤.

<!--
### [Task ID] Task ì´ë¦„

**ì‹¤íŒ¨ ì¼ì‹œ**: YYYY-MM-DD HH:MM
**ì‹¤íŒ¨ ì›ì¸**:
- ì›ì¸ 1
- ì›ì¸ 2

**ì‹œë„í•œ í•´ê²° ë°©ë²•**:
1. í•´ê²° ì‹œë„ 1 â†’ ê²°ê³¼
2. í•´ê²° ì‹œë„ 2 â†’ ê²°ê³¼

**ìµœì¢… í•´ê²° ë°©ë²•**:
- í•´ê²° ë°©ë²• ì„¤ëª…

**êµí›ˆ**:
- í–¥í›„ ìœ ì‚¬ ë¬¸ì œ ë°©ì§€ë¥¼ ìœ„í•œ êµí›ˆ
-->

---

## ì¼ì • ìš”ì•½

| Phase | ì‘ì—… | ê¸°ê°„ | ì„ í–‰ ì¡°ê±´ | ìƒíƒœ |
|-------|------|------|----------|------|
| Phase 1 | ìŠ¤í‚¤ë§ˆ ì¶”ì¶œ | Day 1-2 | - | âœ… ì™„ë£Œ |
| Phase 1.5a | PostgreSQL ì„¤ê³„ ë¬¸ì„œ | Day 2-3 | Phase 1 | âœ… ì™„ë£Œ |
| Phase 1.5b | Neo4j ì„¤ê³„ ë¬¸ì„œ | Day 2-3 | Phase 1 | âœ… ì™„ë£Œ |
| Phase 2 | Alembic ë„ì… | Day 4-5 | Phase 1 | âœ… ì™„ë£Œ |
| Phase 2.5 | DB ì „í™˜ (Testâ†’Production) | Day 5 | Phase 2 | âœ… ì™„ë£Œ |
| Phase 3 | ìŠ¤í¬ë¦½íŠ¸/ê²€ì¦ ë„êµ¬ | Day 6-7 | Phase 1.5a, 2 | âœ… ì™„ë£Œ |
| Phase 4 | Neo4j ìŠ¤í‚¤ë§ˆ | Day 8-9 | Phase 1.5b | âœ… ì™„ë£Œ |
| Phase 5 | pgvector ê´€ë¦¬ | Day 10-11 | Phase 1 | âœ… ì™„ë£Œ |
| Phase 6 | CI/CD í†µí•© | Day 12 | Phase 3 | â¬œ |
| Phase 7 | ì˜¨í†¨ë¡œì§€ í™•ì¥ | Day 13-15 | Phase 4 | âœ… ì™„ë£Œ |
| Phase 8 | ê²€ìƒ‰ ì‹œìŠ¤í…œ | Day 16-17 | Phase 5 | âœ… ì™„ë£Œ |
| Phase 9 | ì—”í‹°í‹° ì¶”ì¶œ íŒŒì´í”„ë¼ì¸ | Day 18 | Phase 7 | âœ… ì™„ë£Œ |

---

## ì°¸ê³  ë¬¸ì„œ

- [database_refactoring.md](./database_refactoring.md) - ë¦¬íŒ©í† ë§ ìƒì„¸ ê³„íš
- [database_status.md](./database_status.md) - í˜„ì¬ DB ìƒíƒœ
- [ontology_concept.md](./design/ontology_concept.md) - ì˜¨í†¨ë¡œì§€ ê°œë… ì„¤ê³„
- [graph_loader.py](../ingestion/graph_loader.py) - Neo4j ë™ê¸°í™” êµ¬í˜„ì²´

---

**ë¬¸ì„œ ë²„ì „**: 2.2
**ìµœì¢… ìˆ˜ì •**: 2025-12-14
**ë³€ê²½ ì´ë ¥**:
- v1.0 (2025-12-13): ì´ˆê¸° ì‘ì„±
- v2.0 (2025-12-13): database_refactoring.md v2.2 ê¸°ë°˜ ì¬ì‘ì„±, ì„ í›„ê´€ê³„ ë°˜ì˜, Phase 1.5ë¥¼ a/bë¡œ ë¶„ë¦¬
- v2.1 (2025-12-13): Phase 2.5 (DB ì „í™˜) ì¶”ê°€, 16ê°œ íŒŒì¼ ìˆ˜ì •, ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ
- v2.2 (2025-12-14): Phase 9 (ì—”í‹°í‹° ì¶”ì¶œ íŒŒì´í”„ë¼ì¸) ì¶”ê°€, 4ê°œ ì¶”ì¶œê¸° êµ¬í˜„, ë¬¸ì„œí™” ì™„ë£Œ
